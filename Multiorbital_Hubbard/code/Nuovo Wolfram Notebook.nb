(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     96265,       2229]
NotebookOptionsPosition[     91657,       2156]
NotebookOutlinePosition[     92060,       2172]
CellTagsIndexPosition[     92017,       2169]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"$Path", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"$Path", ",", " ", 
     RowBox[{
     "{", "\"\<C:\\\\Users\\\\matte\\\\Desktop\\\\Mathematica_package\\\\\>\"\
", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", 
   RowBox[{"(", "\"\<Package.wl\>\"", ")"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.876838575493309*^9, 3.876838601860012*^9}, {
   3.8768386365584726`*^9, 3.8768386826093173`*^9}, {3.8768387385570602`*^9, 
   3.876838774025894*^9}, {3.876838851619028*^9, 3.8768388542587194`*^9}, {
   3.876838927349388*^9, 3.8768389279666343`*^9}, {3.8768392568221645`*^9, 
   3.8768392726543036`*^9}, 3.8768398073881483`*^9, {3.8768399463310003`*^9, 
   3.876839957355627*^9}, {3.8768399936331825`*^9, 3.8768400556017065`*^9}, {
   3.8770909094907494`*^9, 3.877090910935398*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"ec107a83-c730-43bd-99c5-6490f83726d6"],

Cell[BoxData[
 TemplateBox[{
  "Get", "noopen", 
   "\"Cannot open \
\\!\\(\\*RowBox[{\\\"\\\\\\\"Package.wl\\\\\\\"\\\"}]\\).\"", 2, 2, 1, 
   16694609056048278646, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8771001640430384`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"7f04d198-c75c-410b-b4e6-6c5b506349ca"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["$UserBaseDirectory"], "Input",
 CellChangeTimes->{{3.8768394312389936`*^9, 3.876839463787467*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"38c7cc1b-1b1d-41a4-b479-726709c34dd4"],

Cell[BoxData["\<\"C:\\\\Users\\\\matte\\\\AppData\\\\Roaming\\\\Mathematica\"\
\>"], "Output",
 CellChangeTimes->{{3.876839447028305*^9, 3.8768394649803824`*^9}},
 CellLabel->"Out[10]=",ExpressionUUID->"885687e6-daf0-4b12-82a1-f8e0222fb44d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "SetDirectory", "[", 
   "\"\<C:\\\\Users\\\\matte\\\\Desktop\\\\Mathematica_package\\\\\>\"", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Directory", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.8768397596765747`*^9, 3.8768397604594975`*^9}, {
  3.876840071846287*^9, 3.8768400988952894`*^9}, {3.8768401696171603`*^9, 
  3.876840171258775*^9}, {3.876840204059284*^9, 3.876840242020903*^9}, {
  3.8768402735852036`*^9, 3.8768402748580365`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"4cc05509-f747-44b6-9280-93be3516e01a"],

Cell[BoxData["\<\"C:\\\\Users\\\\matte\\\\Desktop\\\\Mathematica_package\"\>"]\
, "Output",
 CellChangeTimes->{
  3.876839760985881*^9, 3.8768401716946735`*^9, {3.8768402070745845`*^9, 
   3.876840236775972*^9}, 3.8768402755423126`*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"941b86ed-0bc5-4a3a-948c-5cd3445c8144"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DistributeDefinitions", "[", 
    RowBox[{"DispersionHypercubic", ",", " ", "DoSBethe"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LocalGreenFunctionNormal", " ", "=", " ", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Energies", ",", "_Real", ",", "1"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"Weights", ",", "_Real", ",", "1"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"\[Mu]", ",", " ", "_Real"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"\[CapitalSigma]", ",", " ", "_Complex", ",", " ", "1"}], 
         "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"zlist", ",", " ", "_Complex", ",", " ", "1"}], "}"}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"LE", " ", "=", " ", 
          RowBox[{"Length", "[", "Energies", "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"compute", " ", "Gloc"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Sum", "[", "\n", "\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"Weights", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "/", 
           RowBox[{"(", 
            RowBox[{"zlist", " ", "+", " ", "\[Mu]", " ", "-", " ", 
             RowBox[{"Energies", "[", 
              RowBox[{"[", "i", "]"}], "]"}], " ", "-", " ", 
             "\[CapitalSigma]"}], ")"}]}], "\n", "\t", ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "LE"}], "}"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "->", 
       RowBox[{"{", "Listable", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LocalGreenFunctionNormalUncompiled", "[", 
     RowBox[{
     "HalfBandwidth_", ",", "\[Mu]_", ",", "\[CapitalSigma]_", ",", 
      "BrillouinZone_", ",", "zlist_", ",", "Momentum_"}], "]"}], " ", ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"Momentum", ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"LE", ",", " ", "d", ",", " ", "t"}], "}"}], ",", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"LE", ",", " ", "d"}], "}"}], " ", "=", " ", 
          RowBox[{"Dimensions", "[", "BrillouinZone", "]"}]}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"t", " ", "=", " ", "HalfBandwidth"}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{"compute", " ", "Gloc"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1.", "/", 
            RowBox[{"LE", "^", "d"}]}], ")"}], " ", "*", " ", 
          RowBox[{"Total", "@", 
           RowBox[{"Table", "[", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{"1.", "/", 
              RowBox[{"(", 
               RowBox[{"zlist", " ", "+", " ", "\[Mu]", " ", "-", " ", 
                RowBox[{"DispersionHypercubic", "[", 
                 RowBox[{"k", ",", " ", "t"}], "]"}], " ", "-", " ", 
                "\[CapitalSigma]"}], ")"}]}], "\n", "\t\t\t", ",", " ", 
             RowBox[{"{", 
              RowBox[{"k", ",", " ", "BrillouinZone"}], "}"}]}], 
            "]"}]}]}]}]}], "\[IndentingNewLine]", "\t", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "LE", ",", " ", "Energies", ",", " ", "DBethe", ",", " ", 
          "d\[Epsilon]"}], "}"}], ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"Energies", " ", "=", " ", 
          RowBox[{"BrillouinZone", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", " ", "1"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"LE", " ", "=", " ", 
          RowBox[{"Length", "[", "Energies", "]"}]}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"DBethe", " ", "=", " ", "HalfBandwidth"}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"d\[Epsilon]", " ", "=", " ", 
          RowBox[{"DBethe", "/", 
           RowBox[{"(", 
            RowBox[{"1.", "*", "LE"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
         "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{"compute", " ", "Gloc"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"d\[Epsilon]", " ", "*", " ", 
          RowBox[{"Total", "@", 
           RowBox[{"Table", "[", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"DoSBethe", "[", 
               RowBox[{"\[Epsilon]", ",", " ", "DBethe"}], "]"}], "/", 
              RowBox[{"(", 
               RowBox[{
               "zlist", " ", "+", " ", "\[Mu]", " ", "-", " ", "\[Epsilon]", 
                " ", "-", " ", "\[CapitalSigma]"}], ")"}]}], "\n", "\t\t\t", 
             ",", " ", 
             RowBox[{"{", 
              RowBox[{"\[Epsilon]", ",", " ", "Energies"}], "}"}]}], 
            "]"}]}]}]}]}], "\[IndentingNewLine]", "\t", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8770036576063986`*^9, 3.8770036710147305`*^9}, {
   3.877003771423774*^9, 3.877003802004617*^9}, {3.8770038368209314`*^9, 
   3.877003849618388*^9}, {3.8770039120134087`*^9, 3.877003945430232*^9}, {
   3.8770039766136436`*^9, 3.8770039780358133`*^9}, {3.877004028181698*^9, 
   3.8770040295069375`*^9}, {3.877004181541247*^9, 3.8770042216126013`*^9}, {
   3.877004263291546*^9, 3.87700434081118*^9}, {3.8770044054722137`*^9, 
   3.8770044218553495`*^9}, {3.877004460118781*^9, 3.877004521751402*^9}, {
   3.8770046048260503`*^9, 3.877004677078224*^9}, {3.877004719169202*^9, 
   3.8770049150043125`*^9}, {3.8770049878247347`*^9, 
   3.8770050443861694`*^9}, {3.877005445475874*^9, 3.877005470569962*^9}, {
   3.8770058951539793`*^9, 3.8770058988645935`*^9}, {3.8770063165818815`*^9, 
   3.8770063170438633`*^9}, {3.877006356825225*^9, 3.8770064742504826`*^9}, {
   3.877006609476741*^9, 3.8770066178468676`*^9}, {3.877007109090577*^9, 
   3.8770071511626177`*^9}, {3.877007227558524*^9, 3.877007285057429*^9}, {
   3.8770076008046246`*^9, 3.8770076305949173`*^9}, {3.877007666921238*^9, 
   3.877007677786087*^9}, {3.8770077597115545`*^9, 3.877007775252224*^9}, {
   3.877007859762618*^9, 3.877007867487545*^9}, {3.8770079006891932`*^9, 
   3.8770079032875643`*^9}, {3.877008205428685*^9, 3.877008212669866*^9}, {
   3.8770085203274393`*^9, 3.8770085330464315`*^9}, {3.8770088034653597`*^9, 
   3.8770088207138977`*^9}, {3.877009656041864*^9, 3.877009700771282*^9}, {
   3.8770098109836426`*^9, 3.8770098178120165`*^9}, {3.8770099228465986`*^9, 
   3.8770099405682764`*^9}, {3.8770099777847605`*^9, 3.87701001883718*^9}, {
   3.877010072906999*^9, 3.877010144389021*^9}, {3.8770101881907473`*^9, 
   3.8770102102788954`*^9}, {3.8770103556085205`*^9, 3.877010387887274*^9}, 
   3.8770104214070625`*^9, {3.877010603162901*^9, 3.877010634508329*^9}, {
   3.8770170624907002`*^9, 3.877017075742322*^9}, {3.877022647252715*^9, 
   3.8770226806319447`*^9}, {3.8770227749823427`*^9, 
   3.8770227754765267`*^9}, {3.8770228174199686`*^9, 
   3.8770229517094374`*^9}, {3.877023937979156*^9, 3.8770239385313125`*^9}, {
   3.87702425732412*^9, 3.8770242715835238`*^9}},
 CellLabel->
  "In[369]:=",ExpressionUUID->"1554ec47-9bd2-4957-848d-e8ac4790ab36"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nMats", " ", "=", " ", "5000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nK", " ", "=", " ", "1000"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalSigma]", "=", 
   RowBox[{"RandomComplex", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1."}], "-", "I"}], ",", 
       RowBox[{"1.", "+", "I"}]}], "}"}], ",", "nMats"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zlist", " ", "=", " ", 
   RowBox[{"I", "*", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.", ",", "1."}], "}"}], ",", "nMats"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BZ", " ", "=", " ", 
    RowBox[{"BrillouinZone", "[", 
     RowBox[{"nK", ",", " ", "d"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Energies", " ", "=", " ", 
     RowBox[{"DispersionHypercubic", "[", 
      RowBox[{"BZ", ",", " ", "1."}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"weights", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"1.", "/", 
        RowBox[{"(", 
         RowBox[{"nK", "^", "d"}], ")"}]}], ",", " ", "nK"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Energies", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"e", ",", " ", 
     RowBox[{"{", 
      RowBox[{"e", ",", 
       RowBox[{"-", "1."}], ",", "1.", ",", "0.002"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"weights", " ", "=", " ", 
    RowBox[{"DoSBethe", "[", 
     RowBox[{"Energies", ",", " ", "1."}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LocalGreenFunctionNormal", "[", 
    RowBox[{
    "Energies", ",", " ", "weights", ",", " ", "0.0", ",", " ", 
     "\[CapitalSigma]", ",", " ", "zlist"}], "]"}], ";"}], "//", 
  "RepeatedTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LocalGreenFunctionNormalUncompiled", "[", 
     RowBox[{
     "1.0", ",", "0.0", ",", "\[CapitalSigma]", ",", "BZ", ",", "zlist", ",", 
      "True"}], "]"}], ";"}], "//", "RepeatedTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Gloc", " ", "=", " ", 
     RowBox[{"LocalGreenFunctionNormal", "[", 
      RowBox[{"Energies", ",", " ", "weights", ",", " ", "0.0", ",", " ", 
       RowBox[{"{", 
        RowBox[{"\[CapitalSigma]", ",", "\[CapitalSigma]"}], "}"}], ",", " ", 
       "zlist"}], "]"}]}], ";"}], ")"}], "//", 
  "RepeatedTiming"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "Gloc", "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQvS+rmeHsozeOR3QieEB0rYGdKoi+OPG4CYg2Elva
CKKjfG2aQPSpo3yTQLTxIpmpYPWL2ZaC6GUXNy8H0ZylnTdA9IavV2+D6IaV
V16AaIH2njcgWmbziV8g+oG+6n8QfS+Yh/sckHbjfCYAou/kZoqCaL+y3dIg
uunxplwQ7W/OkQeiD7/90ANWtyKjF0SvOuEwHUR3aT8C02ZxvvNANM8280Ug
uvDU1mUg2rcvYyWI/rok9dslIJ27vB1MCyVeW3YVSF/bu2YriM7Y4/UbRIsY
2jNdA9IOFz97gOjfMl3+IBoAVzy76Q==
  "],
 CellLabel->
  "In[384]:=",ExpressionUUID->"bc9651f1-2593-467a-9abd-5f28b51d7397"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.135659475`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.877005337177464*^9, 3.877005369529456*^9, 3.877005663373435*^9, {
   3.8770057279353347`*^9, 3.8770057348358555`*^9}, {3.8770059066276035`*^9, 
   3.8770059129948516`*^9}, 3.877006321655625*^9, {3.8770063642025185`*^9, 
   3.877006392240344*^9}, {3.877006505751129*^9, 3.8770065179317083`*^9}, 
   3.8770070711983504`*^9, {3.8770071876528616`*^9, 3.8770072068747425`*^9}, 
   3.877007308784422*^9, 3.877007341052767*^9, 3.8770075111639853`*^9, 
   3.877007558065095*^9, 3.877007589412309*^9, 3.877007642536582*^9, 
   3.8770082469822817`*^9, 3.8770084940996075`*^9, {3.8770085628006744`*^9, 
   3.8770085776306076`*^9}, {3.8770086385853105`*^9, 3.8770086601517706`*^9}, 
   3.877008717602064*^9, {3.877008790499584*^9, 3.8770088296350946`*^9}, 
   3.877009718520955*^9, 3.8770098284778323`*^9, {3.8770099479260073`*^9, 
   3.8770099542399483`*^9}, 3.877010028836702*^9, {3.8770101534159737`*^9, 
   3.8770101793403425`*^9}, 3.8770102249557457`*^9, {3.8770104127589216`*^9, 
   3.8770104288244305`*^9}, 3.8770106232849894`*^9, 3.8770175422519026`*^9, 
   3.877023151821267*^9, 3.87702376790818*^9, 3.8770239543036118`*^9, 
   3.877024352569476*^9, 3.8770243872784815`*^9},
 CellLabel->
  "Out[392]=",ExpressionUUID->"efd9b544-54fb-4145-a0a5-b1b5f9e71128"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.29993645`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.877005337177464*^9, 3.877005369529456*^9, 3.877005663373435*^9, {
   3.8770057279353347`*^9, 3.8770057348358555`*^9}, {3.8770059066276035`*^9, 
   3.8770059129948516`*^9}, 3.877006321655625*^9, {3.8770063642025185`*^9, 
   3.877006392240344*^9}, {3.877006505751129*^9, 3.8770065179317083`*^9}, 
   3.8770070711983504`*^9, {3.8770071876528616`*^9, 3.8770072068747425`*^9}, 
   3.877007308784422*^9, 3.877007341052767*^9, 3.8770075111639853`*^9, 
   3.877007558065095*^9, 3.877007589412309*^9, 3.877007642536582*^9, 
   3.8770082469822817`*^9, 3.8770084940996075`*^9, {3.8770085628006744`*^9, 
   3.8770085776306076`*^9}, {3.8770086385853105`*^9, 3.8770086601517706`*^9}, 
   3.877008717602064*^9, {3.877008790499584*^9, 3.8770088296350946`*^9}, 
   3.877009718520955*^9, 3.8770098284778323`*^9, {3.8770099479260073`*^9, 
   3.8770099542399483`*^9}, 3.877010028836702*^9, {3.8770101534159737`*^9, 
   3.8770101793403425`*^9}, 3.8770102249557457`*^9, {3.8770104127589216`*^9, 
   3.8770104288244305`*^9}, 3.8770106232849894`*^9, 3.8770175422519026`*^9, 
   3.877023151821267*^9, 3.87702376790818*^9, 3.8770239543036118`*^9, 
   3.877024352569476*^9, 3.8770243897229433`*^9},
 CellLabel->
  "Out[393]=",ExpressionUUID->"7280c559-64ea-4e88-b922-8b7b0442a26f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.131525225`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.877005337177464*^9, 3.877005369529456*^9, 3.877005663373435*^9, {
   3.8770057279353347`*^9, 3.8770057348358555`*^9}, {3.8770059066276035`*^9, 
   3.8770059129948516`*^9}, 3.877006321655625*^9, {3.8770063642025185`*^9, 
   3.877006392240344*^9}, {3.877006505751129*^9, 3.8770065179317083`*^9}, 
   3.8770070711983504`*^9, {3.8770071876528616`*^9, 3.8770072068747425`*^9}, 
   3.877007308784422*^9, 3.877007341052767*^9, 3.8770075111639853`*^9, 
   3.877007558065095*^9, 3.877007589412309*^9, 3.877007642536582*^9, 
   3.8770082469822817`*^9, 3.8770084940996075`*^9, {3.8770085628006744`*^9, 
   3.8770085776306076`*^9}, {3.8770086385853105`*^9, 3.8770086601517706`*^9}, 
   3.877008717602064*^9, {3.877008790499584*^9, 3.8770088296350946`*^9}, 
   3.877009718520955*^9, 3.8770098284778323`*^9, {3.8770099479260073`*^9, 
   3.8770099542399483`*^9}, 3.877010028836702*^9, {3.8770101534159737`*^9, 
   3.8770101793403425`*^9}, 3.8770102249557457`*^9, {3.8770104127589216`*^9, 
   3.8770104288244305`*^9}, 3.8770106232849894`*^9, 3.8770175422519026`*^9, 
   3.877023151821267*^9, 3.87702376790818*^9, 3.8770239543036118`*^9, 
   3.877024352569476*^9, 3.8770243917505164`*^9},
 CellLabel->
  "Out[394]=",ExpressionUUID->"c6087ae8-9306-43e3-9efd-20d2bf22eb77"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "5000"}], "}"}]], "Output",
 CellChangeTimes->{
  3.877005337177464*^9, 3.877005369529456*^9, 3.877005663373435*^9, {
   3.8770057279353347`*^9, 3.8770057348358555`*^9}, {3.8770059066276035`*^9, 
   3.8770059129948516`*^9}, 3.877006321655625*^9, {3.8770063642025185`*^9, 
   3.877006392240344*^9}, {3.877006505751129*^9, 3.8770065179317083`*^9}, 
   3.8770070711983504`*^9, {3.8770071876528616`*^9, 3.8770072068747425`*^9}, 
   3.877007308784422*^9, 3.877007341052767*^9, 3.8770075111639853`*^9, 
   3.877007558065095*^9, 3.877007589412309*^9, 3.877007642536582*^9, 
   3.8770082469822817`*^9, 3.8770084940996075`*^9, {3.8770085628006744`*^9, 
   3.8770085776306076`*^9}, {3.8770086385853105`*^9, 3.8770086601517706`*^9}, 
   3.877008717602064*^9, {3.877008790499584*^9, 3.8770088296350946`*^9}, 
   3.877009718520955*^9, 3.8770098284778323`*^9, {3.8770099479260073`*^9, 
   3.8770099542399483`*^9}, 3.877010028836702*^9, {3.8770101534159737`*^9, 
   3.8770101793403425`*^9}, 3.8770102249557457`*^9, {3.8770104127589216`*^9, 
   3.8770104288244305`*^9}, 3.8770106232849894`*^9, 3.8770175422519026`*^9, 
   3.877023151821267*^9, 3.87702376790818*^9, 3.8770239543036118`*^9, 
   3.877024352569476*^9, 3.8770243917545056`*^9},
 CellLabel->
  "Out[395]=",ExpressionUUID->"99c98edf-6caf-4276-ae70-8199358c02c4"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "LocalGreenFunctionSuperc", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LocalGreenFunctionSuperc", " ", "=", " ", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Energies", ",", "_Real", ",", "1"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"weights", ",", " ", "_Real", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Mu]", ",", " ", "_Real"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"\[CapitalSigma]", ",", " ", "_Complex", ",", " ", "3"}], 
         "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"zlist", ",", " ", "_Complex", ",", " ", "1"}], "}"}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"LE", " ", "=", " ", 
           RowBox[{"Length", "[", "Energies", "]"}]}], ",", " ", 
          RowBox[{"LocalGF", " ", "=", " ", 
           RowBox[{"0", "*", "\[CapitalSigma]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"compute", " ", "normal", " ", "component"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{
          RowBox[{"LocalGF", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
          RowBox[{"Sum", "[", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"weights", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", " ", "zlist"}], " ", "+", " ", "\[Mu]", " ", "-",
                 " ", 
                RowBox[{"Conjugate", "@", 
                 RowBox[{"\[CapitalSigma]", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}]}], " ", 
                "-", " ", 
                RowBox[{"Energies", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"zlist", " ", "+", " ", "\[Mu]", " ", "-", " ", 
                   RowBox[{"\[CapitalSigma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], " ", 
                   "-", " ", 
                   RowBox[{"Energies", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "^", "2"}], " ", 
                "+", " ", 
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"\[CapitalSigma]", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], 
                 "^", "2"}]}], ")"}]}]}], "\n", "\t\t", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", "LE"}], "}"}]}], "]"}]}], ";", "\n", 
         "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{"compute", " ", "anomalous", " ", "component"}], " ", 
          "*)"}], "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"LocalGF", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"\[CapitalSigma]", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}]}], "*", 
           RowBox[{"Sum", "[", "\n", "\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"weights", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"zlist", " ", "+", " ", "\[Mu]", " ", "-", " ", 
                   RowBox[{"\[CapitalSigma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], " ", 
                   "-", " ", 
                   RowBox[{"Energies", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "^", "2"}], " ", 
                "+", " ", 
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"\[CapitalSigma]", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], 
                 "^", "2"}]}], ")"}]}], "\n", "\t\t", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", "LE"}], "}"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", " ", 
          RowBox[{"compute", " ", "the", " ", "full", " ", "matrix"}], " ", 
          "*)"}], "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"LocalGF", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
          RowBox[{"-", " ", 
           RowBox[{"Conjugate", "[", 
            RowBox[{"LocalGF", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], "]"}]}]}], 
         ";", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"LocalGF", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
          RowBox[{"Conjugate", "[", 
           RowBox[{"LocalGF", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t", "LocalGF"}]}], "\[IndentingNewLine]", 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "->", 
       RowBox[{"{", "Listable", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LocalGreenFunctionSupercUncompiled", "[", 
    RowBox[{
    "HalfBandwidth_", ",", "\[Mu]_", ",", "\[CapitalSigma]_", ",", 
     "BrillouinZone_", ",", "zlist_", ",", "Momentum_"}], "]"}], " ", ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{"Momentum", ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"LE", ",", " ", "d", ",", " ", "t", ",", " ", 
         RowBox[{"LocalGF", " ", "=", " ", 
          RowBox[{"0", "*", "\[CapitalSigma]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"LE", ",", " ", "d"}], "}"}], " ", "=", " ", 
         RowBox[{"Dimensions", "[", "BrillouinZone", "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"t", " ", "=", " ", "HalfBandwidth"}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{"compute", " ", "normal", " ", "component"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"LocalGF", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1.", "/", 
            RowBox[{"LE", "^", "d"}]}], ")"}], " ", "*", " ", 
          RowBox[{"Total", "@", 
           RowBox[{"Table", "[", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", " ", "zlist"}], " ", "+", " ", "\[Mu]", " ", "-",
                 " ", 
                RowBox[{"Conjugate", "@", 
                 RowBox[{"\[CapitalSigma]", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}]}], " ", 
                "-", " ", 
                RowBox[{"DispersionHypercubic", "[", 
                 RowBox[{"k", ",", " ", "t"}], "]"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"zlist", " ", "+", " ", "\[Mu]", " ", "-", " ", 
                   RowBox[{"\[CapitalSigma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], " ", 
                   "-", " ", 
                   RowBox[{"DispersionHypercubic", "[", 
                    RowBox[{"k", ",", " ", "t"}], "]"}]}], "]"}], "^", "2"}], 
                " ", "+", " ", 
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"\[CapitalSigma]", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], 
                 "^", "2"}]}], ")"}]}], "\n", "\t\t\t", ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", " ", "BrillouinZone"}], "}"}]}], "]"}]}]}]}], 
        ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{"compute", " ", "anomalous", " ", "component"}], " ", "*)"}],
         "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"LocalGF", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"\[CapitalSigma]", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}]}], "*", 
          RowBox[{"(", 
           RowBox[{"1.", "/", 
            RowBox[{"LE", "^", "d"}]}], ")"}], "*", 
          RowBox[{"Total", "@", 
           RowBox[{"Table", "[", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{"1.", "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"zlist", " ", "+", " ", "\[Mu]", " ", "-", " ", 
                   RowBox[{"\[CapitalSigma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], " ", 
                   "-", " ", 
                   RowBox[{"DispersionHypercubic", "[", 
                    RowBox[{"k", ",", " ", "t"}], "]"}]}], "]"}], "^", "2"}], 
                " ", "+", " ", 
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"\[CapitalSigma]", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], 
                 "^", "2"}]}], ")"}]}], "\n", "\t\t\t", ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", " ", "BrillouinZone"}], "}"}]}], "]"}]}]}]}], 
        ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{"compute", " ", "the", " ", "full", " ", "matrix"}], " ", 
         "*)"}], "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"LocalGF", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
         RowBox[{"-", " ", 
          RowBox[{"Conjugate", "[", 
           RowBox[{"LocalGF", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"LocalGF", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
         RowBox[{"Conjugate", "[", 
          RowBox[{"LocalGF", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", "LocalGF"}]}], "\[IndentingNewLine]", 
      "\t", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "LE", ",", " ", "Energies", ",", " ", "DBethe", ",", " ", 
         "d\[Epsilon]", ",", " ", 
         RowBox[{"LocalGF", " ", "=", " ", 
          RowBox[{"0", "*", "\[CapitalSigma]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"Energies", " ", "=", " ", 
         RowBox[{"BrillouinZone", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", " ", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"LE", " ", "=", " ", 
         RowBox[{"Length", "[", "Energies", "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"DBethe", " ", "=", " ", "HalfBandwidth"}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"d\[Epsilon]", " ", "=", " ", 
         RowBox[{"DBethe", "/", 
          RowBox[{"(", 
           RowBox[{"1.", "*", "LE"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{"compute", " ", "normal", " ", "component"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"LocalGF", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
         RowBox[{"d\[Epsilon]", "*", 
          RowBox[{"Total", "@", 
           RowBox[{"Table", "[", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"DoSBethe", "[", 
               RowBox[{"\[Epsilon]", ",", " ", "DBethe"}], "]"}], "*", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "zlist"}], " ", "+", " ", "\[Mu]", " ", "-", 
                 " ", 
                 RowBox[{"Conjugate", "@", 
                  RowBox[{"\[CapitalSigma]", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}]}], " ", 
                 "-", " ", "\[Epsilon]"}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{"zlist", " ", "+", " ", "\[Mu]", " ", "-", " ", 
                    RowBox[{"\[CapitalSigma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], " ", 
                    "-", " ", "\[Epsilon]"}], "]"}], "^", "2"}], " ", "+", 
                 " ", 
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{"\[CapitalSigma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], 
                  "^", "2"}]}], ")"}]}]}], "\n", "\t\t\t", ",", 
             RowBox[{"{", 
              RowBox[{"\[Epsilon]", ",", " ", "Energies"}], "}"}]}], 
            "]"}]}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{"compute", " ", "anomalous", " ", "component"}], " ", "*)"}],
         "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"LocalGF", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"\[CapitalSigma]", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}]}], "*", 
          "d\[Epsilon]", "*", 
          RowBox[{"Total", "@", 
           RowBox[{"Table", "[", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"DoSBethe", "[", 
               RowBox[{"\[Epsilon]", ",", " ", "DBethe"}], "]"}], "*", 
              RowBox[{"(", 
               RowBox[{"1.", "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Abs", "[", 
                    RowBox[{"zlist", " ", "+", " ", "\[Mu]", " ", "-", " ", 
                    RowBox[{"\[CapitalSigma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], " ", 
                    "-", " ", "\[Epsilon]"}], "]"}], "^", "2"}], " ", "+", 
                  " ", 
                  RowBox[{
                   RowBox[{"Abs", "[", 
                    RowBox[{"\[CapitalSigma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], 
                   "^", "2"}]}], ")"}]}], ")"}]}], "\n", "\t\t\t", ",", 
             RowBox[{"{", 
              RowBox[{"\[Epsilon]", ",", " ", "Energies"}], "}"}]}], 
            "]"}]}]}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"compute", " ", "the", " ", "full", " ", "matrix"}], " ", 
         "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"LocalGF", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
         RowBox[{"-", " ", 
          RowBox[{"Conjugate", "[", 
           RowBox[{"LocalGF", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"LocalGF", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
         RowBox[{"Conjugate", "[", 
          RowBox[{"LocalGF", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", "LocalGF"}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8770166821874695`*^9, 3.8770167212301645`*^9}, {
   3.877016817876439*^9, 3.8770168750445724`*^9}, {3.877016913026129*^9, 
   3.8770170474741845`*^9}, {3.877017109112997*^9, 3.877017242741101*^9}, {
   3.877017282590925*^9, 3.877017501479192*^9}, {3.8770175955223923`*^9, 
   3.8770176010240154`*^9}, {3.877017760140183*^9, 3.8770177722244616`*^9}, 
   3.877017930635284*^9, {3.877018252214225*^9, 3.8770182537539797`*^9}, {
   3.8770182928905883`*^9, 3.8770183619451036`*^9}, {3.877018488123929*^9, 
   3.8770185086254377`*^9}, {3.8770185813921165`*^9, 
   3.8770186146474037`*^9}, {3.8770186457824507`*^9, 
   3.8770187479890547`*^9}, {3.877018781414155*^9, 3.877018924176264*^9}, {
   3.8770189879520597`*^9, 3.8770189952195807`*^9}, {3.8770199959799356`*^9, 
   3.877019999471611*^9}, {3.877020254904625*^9, 3.8770203705551834`*^9}, {
   3.8770238482479687`*^9, 3.8770239110765247`*^9}, {3.8770239821613846`*^9, 
   3.8770242101425705`*^9}, {3.877024602540379*^9, 3.8770246121559157`*^9}, {
   3.877024655324448*^9, 3.8770246561278477`*^9}, {3.8770249904854*^9, 
   3.8770249946638947`*^9}, {3.877025031645687*^9, 3.877025032422705*^9}},
 CellLabel->
  "In[473]:=",ExpressionUUID->"7671d138-d6c9-4a7d-9714-836b6ff1ea41"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nMats", " ", "=", " ", "5000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nK", " ", "=", " ", "1000"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalSigma]", "=", 
   RowBox[{"RandomComplex", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1."}], "-", "I"}], ",", 
       RowBox[{"1.", "+", "I"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nMats", ",", "2", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zlist", " ", "=", " ", 
   RowBox[{"I", "*", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.", ",", "1."}], "}"}], ",", "nMats"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BZ", " ", "=", " ", 
    RowBox[{"BrillouinZone", "[", 
     RowBox[{"nK", ",", " ", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Energies", " ", "=", " ", 
     RowBox[{"DispersionHypercubic", "[", 
      RowBox[{"BZ", ",", " ", "1."}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"weights", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"1.", "/", 
        RowBox[{"(", 
         RowBox[{"nK", "^", "d"}], ")"}]}], ",", " ", "nK"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Energies", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"e", ",", " ", 
     RowBox[{"{", 
      RowBox[{"e", ",", 
       RowBox[{"-", "1."}], ",", "1.", ",", "0.002"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"weights", " ", "=", " ", 
    RowBox[{"DoSBethe", "[", 
     RowBox[{"Energies", ",", " ", "1."}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Gloc", " ", "=", " ", 
     RowBox[{"LocalGreenFunctionSuperc", "[", 
      RowBox[{
      "Energies", ",", " ", "weights", ",", " ", "0.0", ",", " ", 
       "\[CapitalSigma]", ",", " ", "zlist"}], "]"}]}], ";"}], ")"}], "//", 
  "RepeatedTiming"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "Gloc", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LocalGreenFunctionSupercUncompiled", "[", 
     RowBox[{
     "1.0", ",", " ", "0.0", ",", " ", "\[CapitalSigma]", ",", " ", "BZ", ",",
       " ", "zlist", ",", " ", "True"}], "]"}], ";"}], "//", 
   "RepeatedTiming"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Gloc", " ", "=", " ", 
     RowBox[{"LocalGreenFunctionSuperc", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Energies", ",", " ", 
         RowBox[{"\[Alpha]", "*", "Energies"}]}], "}"}], ",", " ", "weights", 
       ",", " ", "0.0", ",", " ", 
       RowBox[{"{", 
        RowBox[{"\[CapitalSigma]", ",", "\[CapitalSigma]"}], "}"}], ",", " ", 
       "zlist"}], "]"}]}], ";"}], ")"}], "//", 
  "RepeatedTiming"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "Gloc", "]"}]}], "Input",
 CellChangeTimes->{{3.877019858123801*^9, 3.877019909750228*^9}, {
  3.877019948835116*^9, 3.877019988244337*^9}, {3.877020023854064*^9, 
  3.877020024573694*^9}, {3.8770203939271736`*^9, 3.8770204114893827`*^9}, {
  3.877020453836027*^9, 3.877020494497882*^9}, {3.877024675248508*^9, 
  3.8770247399194593`*^9}, {3.877024782361357*^9, 3.877024809019561*^9}, {
  3.8770248768430395`*^9, 3.8770248788220816`*^9}, {3.8770262472205677`*^9, 
  3.877026250900236*^9}},
 CellLabel->
  "In[489]:=",ExpressionUUID->"5f260183-e281-448d-a532-6030190dee1f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.59661595`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8770199157868223`*^9, 3.877019968115041*^9, 3.8770200076974916`*^9, 
   3.8770204191983757`*^9, {3.8770204842875876`*^9, 3.8770204981677494`*^9}, 
   3.8770247464302187`*^9, 3.877024812008727*^9, 3.877024882015622*^9, {
   3.8770250112988825`*^9, 3.8770250397038383`*^9}, 3.8770262572459126`*^9},
 CellLabel->
  "Out[496]=",ExpressionUUID->"37ae0afb-3d26-4d26-853c-15214d2a32b9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5000", ",", "2", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8770199157868223`*^9, 3.877019968115041*^9, 3.8770200076974916`*^9, 
   3.8770204191983757`*^9, {3.8770204842875876`*^9, 3.8770204981677494`*^9}, 
   3.8770247464302187`*^9, 3.877024812008727*^9, 3.877024882015622*^9, {
   3.8770250112988825`*^9, 3.8770250397038383`*^9}, 3.8770262572508993`*^9},
 CellLabel->
  "Out[497]=",ExpressionUUID->"a2dead5d-6844-4b93-8ad4-942291ba0785"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.2096345`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8770199157868223`*^9, 3.877019968115041*^9, 3.8770200076974916`*^9, 
   3.8770204191983757`*^9, {3.8770204842875876`*^9, 3.8770204981677494`*^9}, 
   3.8770247464302187`*^9, 3.877024812008727*^9, 3.877024882015622*^9, {
   3.8770250112988825`*^9, 3.8770250397038383`*^9}, 3.8770262596993484`*^9},
 CellLabel->
  "Out[498]=",ExpressionUUID->"841519e0-17bf-43ee-b865-9c70990a8a94"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.5143005`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8770199157868223`*^9, 3.877019968115041*^9, 3.8770200076974916`*^9, 
   3.8770204191983757`*^9, {3.8770204842875876`*^9, 3.8770204981677494`*^9}, 
   3.8770247464302187`*^9, 3.877024812008727*^9, 3.877024882015622*^9, {
   3.8770250112988825`*^9, 3.8770250397038383`*^9}, 3.8770262617618895`*^9},
 CellLabel->
  "Out[500]=",ExpressionUUID->"2df5a0f4-d9a4-4666-8e90-42450c74d48a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "5000", ",", "2", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8770199157868223`*^9, 3.877019968115041*^9, 3.8770200076974916`*^9, 
   3.8770204191983757`*^9, {3.8770204842875876`*^9, 3.8770204981677494`*^9}, 
   3.8770247464302187`*^9, 3.877024812008727*^9, 3.877024882015622*^9, {
   3.8770250112988825`*^9, 3.8770250397038383`*^9}, 3.8770262617668624`*^9},
 CellLabel->
  "Out[501]=",ExpressionUUID->"8dd90e39-536c-4b35-b06b-3f8ed682202c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Internal`CompileValues", "[", "]"}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"to", " ", "trigger", " ", "auto"}], "-", "load"}], "*)"}], 
    "\n", 
    RowBox[{"ClearAttributes", "[", 
     RowBox[{"Internal`CompileValues", ",", "ReadProtected"}], "]"}], ";", 
    "\n", 
    RowBox[{"syms", "=", 
     RowBox[{
      RowBox[{"DownValues", "[", "Internal`CompileValues", "]"}], "/.", " ", 
      RowBox[{
       RowBox[{"HoldPattern", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Verbatim", "[", "HoldPattern", "]"}], "[", 
          RowBox[{"Internal`CompileValues", "[", "sym_", "]"}], "]"}], ":>", 
         "_"}], "]"}], ":>", "sym"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Complement", "[", 
     RowBox[{"syms", ",", 
      RowBox[{"Compile`CompilerFunctions", "[", "]"}]}], "]"}]}], "*)"}], 
  "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"TwoByTwoInverse", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"A", ",", " ", "_Complex", ",", "2"}], "}"}], 
        "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1.", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"A", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
              RowBox[{"A", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"A", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", 
              RowBox[{"A", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], ")"}]}], ")"}], 
         "*", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
             RowBox[{"-", 
              RowBox[{"A", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"A", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}]}], "}"}]}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"invA", ",", "a", ",", "b", ",", "c", ",", "d"}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"a", "=", 
           RowBox[{"A", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", " ", 
          RowBox[{"b", "=", 
           RowBox[{"A", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", " ", 
          RowBox[{"c", "=", 
           RowBox[{"A", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", 
          RowBox[{"d", "=", 
           RowBox[{"A", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"invA", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1.", "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a", "*", "d"}], "-", 
                RowBox[{"b", "*", "c"}]}], ")"}]}], ")"}], "*", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"d", ",", 
                RowBox[{"-", "b"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "c"}], ",", "a"}], "}"}]}], "}"}]}]}]}]}], 
        "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
       RowBox[{"RuntimeAttributes", "->", 
        RowBox[{"{", "Listable", "}"}]}], ",", 
       RowBox[{"Parallelization", "->", "True"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LocalGreenFunctionInterorbNormal", "=", " ", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Energies", ",", "_Real", ",", "3"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"weights", ",", "_Real", ",", "1"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"\[Mu]", ",", " ", "_Real"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"\[CapitalSigma]", ",", " ", "_Complex", ",", " ", "3"}], 
          "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"zlist", ",", " ", "_Complex", ",", " ", "1"}], "}"}]}], 
        "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"LE", " ", "=", " ", 
            RowBox[{"Length", "[", "Energies", "]"}]}], ",", " ", 
           RowBox[{"Norb", " ", "=", " ", 
            RowBox[{"Length", "[", 
             RowBox[{"Energies", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", " ", 
           RowBox[{"NMatsubara", " ", "=", " ", 
            RowBox[{"Length", "[", "zlist", "]"}]}]}], "}"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", " ", 
          RowBox[{"compute", " ", "Gloc"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"Sum", "[", "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{
               RowBox[{"weights", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "*", 
               RowBox[{"Inverse", "[", "\[IndentingNewLine]", "\t", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"IdentityMatrix", "[", "Norb", "]"}], "*", "#"}], 
                  ")"}], " ", "-", " ", 
                 RowBox[{"Energies", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "\[IndentingNewLine]", 
                "\t", "]"}]}], "\n", "\t\t", ",", " ", 
              RowBox[{"{", 
               RowBox[{"i", ",", " ", "LE"}], "}"}]}], "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{"zlist", "+", "\[Mu]"}], ")"}]}], "\[IndentingNewLine]", 
          "*)"}], "\[IndentingNewLine]", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"SLOW", " ", "!"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Total", "@", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"weights", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"TwoByTwoInverse", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"IdentityMatrix", "[", "Norb", "]"}], "*", "#"}], 
                  ")"}], "&"}], "/@", 
                RowBox[{"(", 
                 RowBox[{"zlist", "+", "\[Mu]"}], ")"}]}], " ", "-", " ", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{
                 RowBox[{"Energies", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "NMatsubara"}], "]"}], 
               " ", "-", " ", "\[CapitalSigma]"}], "\[IndentingNewLine]", 
              "]"}]}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "LE"}], "}"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"RuntimeAttributes", "->", 
        RowBox[{"{", "Listable", "}"}]}], ",", 
       RowBox[{"Parallelization", "->", "True"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LocalGreenFunctionInterorbNormalUncompiled", "[", 
      RowBox[{
      "Energies_", ",", "weights_", ",", "\[Mu]_", ",", "\[CapitalSigma]_", 
       ",", "zlist_"}], "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LE", " ", "=", " ", 
          RowBox[{"Length", "[", "Energies", "]"}]}], ",", " ", 
         RowBox[{"Norb", " ", "=", " ", 
          RowBox[{"Length", "[", 
           RowBox[{"Energies", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"compute", " ", "Gloc"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "@", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{
             RowBox[{"weights", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"Inverse", "[", 
              RowBox[{"SparseArray", "[", "\[IndentingNewLine]", "\t", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"IdentityMatrix", "[", "Norb", "]"}], "*", "#"}], 
                 ")"}], " ", "-", " ", 
                RowBox[{"Energies", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "\[IndentingNewLine]", 
               "]"}], "]"}]}], "\n", "\t\t", ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", "LE"}], "}"}]}], "]"}]}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"zlist", "+", "\[Mu]"}], ")"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8770209087161913`*^9, 3.877020923033988*^9}, 
   3.8770209796367054`*^9, {3.877021062931445*^9, 3.877021064367126*^9}, {
   3.8770211156459074`*^9, 3.8770211157622194`*^9}, {3.87702116716603*^9, 
   3.877021216615403*^9}, {3.8770252631171975`*^9, 3.877025309758898*^9}, {
   3.877025361260706*^9, 3.877025388607372*^9}, {3.8770256237846017`*^9, 
   3.8770256300793576`*^9}, {3.8770262937820435`*^9, 
   3.8770263772238317`*^9}, {3.8770264158799543`*^9, 
   3.8770264324726877`*^9}, {3.877026506377138*^9, 3.877026533165214*^9}, {
   3.877026563435174*^9, 3.8770265656948333`*^9}, {3.8770622352477913`*^9, 
   3.8770623326195498`*^9}, {3.8770626219285083`*^9, 
   3.8770626331124315`*^9}, {3.8770626704463434`*^9, 
   3.8770626746560555`*^9}, {3.8770628299874935`*^9, 
   3.8770628673104362`*^9}, {3.8770629134153013`*^9, 
   3.8770629160294704`*^9}, {3.877063186085546*^9, 3.877063217644731*^9}, {
   3.8770632597477307`*^9, 3.877063265100093*^9}, {3.877063901087417*^9, 
   3.877063912413062*^9}, {3.87706423664999*^9, 3.8770642848595705`*^9}, {
   3.8770643283359737`*^9, 3.8770643459217997`*^9}, {3.877064544870141*^9, 
   3.8770645539676423`*^9}, {3.8770647972828107`*^9, 
   3.8770647989360867`*^9}, {3.877064898850988*^9, 3.87706490900468*^9}, {
   3.877064998419573*^9, 3.877065000186351*^9}, {3.8770650847771025`*^9, 
   3.8770650876828995`*^9}, {3.877065487412748*^9, 3.8770655577917585`*^9}, {
   3.8770655927039146`*^9, 3.8770656186909924`*^9}, {3.87706657776783*^9, 
   3.8770666148513327`*^9}, 3.87706666122552*^9, {3.877066816850171*^9, 
   3.8770668574424996`*^9}, {3.8770669132383785`*^9, 
   3.8770669184182405`*^9}, {3.8770672813868465`*^9, 
   3.8770672851357355`*^9}, {3.877067562708253*^9, 3.8770675697802954`*^9}, {
   3.8770676187124662`*^9, 3.877067621551155*^9}, {3.8770676607097445`*^9, 
   3.877067671356285*^9}, {3.877067818719175*^9, 3.8770678312062745`*^9}, {
   3.8770679350941877`*^9, 3.8770679381472616`*^9}, {3.8770681690594077`*^9, 
   3.877068210604375*^9}, 3.8770733893211727`*^9, {3.8770737337745905`*^9, 
   3.8770737859394293`*^9}, {3.8770764387086163`*^9, 3.877076466812499*^9}, {
   3.8770819080438223`*^9, 3.8770819115341644`*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"dc874c6a-6359-483f-83a4-5af588992eae"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nMats", " ", "=", " ", "5000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nK", " ", "=", " ", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Norb", "=", "2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalSigma]", "=", 
   RowBox[{"RandomComplex", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1."}], "-", "I"}], ",", 
       RowBox[{"1.", "+", "I"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nMats", ",", "Norb", ",", "Norb"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zlist", " ", "=", " ", 
   RowBox[{"I", "*", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.", ",", "1."}], "}"}], ",", "nMats"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d", "=", "1"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BZ", " ", "=", " ", 
     RowBox[{"BrillouinZone", "[", 
      RowBox[{"nK", ",", " ", "d"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Energies", " ", "=", " ", 
     RowBox[{"DispersionHypercubic", "[", 
      RowBox[{"BZ", ",", " ", "1."}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"weights", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"1.", "/", 
        RowBox[{"(", 
         RowBox[{"nK", "^", "d"}], ")"}]}], ",", " ", "nK"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Alpha]", "=", "0.5"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Energies", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"e", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"\[Alpha]", "*", "e"}]}], "}"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"e", ",", 
       RowBox[{"-", "1."}], ",", "1.", ",", "0.01"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"weights", " ", "=", " ", 
    RowBox[{"DoSBethe", "[", 
     RowBox[{
      RowBox[{"Energies", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], ",", " ", "1."}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Gloc", " ", "=", " ", 
     RowBox[{"LocalGreenFunctionInterorbNormal", "[", 
      RowBox[{
      "Energies", ",", " ", "weights", ",", " ", "0.0", ",", " ", 
       "\[CapitalSigma]", ",", " ", "zlist"}], "]"}]}], ";"}], ")"}], "//", 
  "RepeatedTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dimensions", "[", "Gloc", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Gloc", " ", "=", " ", 
     RowBox[{"LocalGreenFunctionInterorbNormalUncompiled", "[", 
      RowBox[{
      "Energies", ",", " ", "weights", ",", " ", "0.0", ",", " ", 
       "\[CapitalSigma]", ",", " ", "zlist"}], "]"}]}], ";"}], ")"}], "//", 
  "RepeatedTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dimensions", "[", "Gloc", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DistributeDefinitions", "[", "TwoByTwoInverse", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LocalGreenFunctionInterorbNormal", "[", 
    RowBox[{"Energies", ",", " ", "weights", ",", " ", "0.0", ",", " ", 
     RowBox[{"{", 
      RowBox[{"\[CapitalSigma]", ",", "\[CapitalSigma]"}], "}"}], ",", " ", 
     "zlist"}], "]"}], ";"}], "//", "RepeatedTiming"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "Gloc", "]"}]}], "Input",
 CellChangeTimes->{{3.8770635305029707`*^9, 3.8770636401034455`*^9}, {
   3.8770637334006877`*^9, 3.877063776894114*^9}, {3.8770655753171573`*^9, 
   3.877065581305503*^9}, {3.877066668551677*^9, 3.8770666708524313`*^9}, {
   3.877067055202568*^9, 3.877067084013429*^9}, {3.877068103781519*^9, 
   3.877068106290784*^9}, 3.8770683536659408`*^9, 3.87706842286475*^9, {
   3.877073409769879*^9, 3.8770734148311186`*^9}, {3.8770814036740403`*^9, 
   3.8770814184430323`*^9}, {3.8770814657692595`*^9, 3.877081542308091*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"604c1490-9df0-4389-9b07-7a7b5ab43114"],

Cell[BoxData["0.5`"], "Output",
 CellChangeTimes->{
  3.877063640689625*^9, {3.877063754262088*^9, 3.877063778978283*^9}, 
   3.877064355453601*^9, 3.877064563229081*^9, 3.8770648172356677`*^9, 
   3.8770649182267847`*^9, 3.877065010806564*^9, 3.8770656322374463`*^9, 
   3.877066671467812*^9, 3.8770668670278654`*^9, 3.877066925781698*^9, 
   3.87706708491*^9, 3.877067291702668*^9, 3.8770675795711827`*^9, 
   3.877067629573022*^9, 3.8770676773962393`*^9, 3.8770678379502745`*^9, 
   3.8770679509145284`*^9, 3.877068218819289*^9, 3.8770683559408937`*^9, 
   3.877073416230164*^9, {3.8770737407463083`*^9, 3.8770737911392803`*^9}, 
   3.8770738395541353`*^9, 3.8770764894603524`*^9, 3.87708143964832*^9, 
   3.8770815027910357`*^9, 3.8770815430521307`*^9, 3.877081922484112*^9},
 CellLabel->
  "Out[125]=",ExpressionUUID->"1f26655e-b923-4909-b2c6-773e5bac6a25"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.8527344`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.877063640689625*^9, {3.877063754262088*^9, 3.877063778978283*^9}, 
   3.877064355453601*^9, 3.877064563229081*^9, 3.8770648172356677`*^9, 
   3.8770649182267847`*^9, 3.877065010806564*^9, 3.8770656322374463`*^9, 
   3.877066671467812*^9, 3.8770668670278654`*^9, 3.877066925781698*^9, 
   3.87706708491*^9, 3.877067291702668*^9, 3.8770675795711827`*^9, 
   3.877067629573022*^9, 3.8770676773962393`*^9, 3.8770678379502745`*^9, 
   3.8770679509145284`*^9, 3.877068218819289*^9, 3.8770683559408937`*^9, 
   3.877073416230164*^9, {3.8770737407463083`*^9, 3.8770737911392803`*^9}, 
   3.8770738395541353`*^9, 3.8770764894603524`*^9, 3.87708143964832*^9, 
   3.8770815027910357`*^9, 3.8770815430521307`*^9, 3.8770819259298773`*^9},
 CellLabel->
  "Out[128]=",ExpressionUUID->"372b81ef-7bde-4a86-8792-b0719eee4d12"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5000", ",", "2", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{
  3.877063640689625*^9, {3.877063754262088*^9, 3.877063778978283*^9}, 
   3.877064355453601*^9, 3.877064563229081*^9, 3.8770648172356677`*^9, 
   3.8770649182267847`*^9, 3.877065010806564*^9, 3.8770656322374463`*^9, 
   3.877066671467812*^9, 3.8770668670278654`*^9, 3.877066925781698*^9, 
   3.87706708491*^9, 3.877067291702668*^9, 3.8770675795711827`*^9, 
   3.877067629573022*^9, 3.8770676773962393`*^9, 3.8770678379502745`*^9, 
   3.8770679509145284`*^9, 3.877068218819289*^9, 3.8770683559408937`*^9, 
   3.877073416230164*^9, {3.8770737407463083`*^9, 3.8770737911392803`*^9}, 
   3.8770738395541353`*^9, 3.8770764894603524`*^9, 3.87708143964832*^9, 
   3.8770815027910357`*^9, 3.8770815430521307`*^9, 3.8770819259358606`*^9},
 CellLabel->
  "Out[129]=",ExpressionUUID->"06a53c90-6fe9-43f5-b9c1-513fa08bd1c7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"15.7043848`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.877063640689625*^9, {3.877063754262088*^9, 3.877063778978283*^9}, 
   3.877064355453601*^9, 3.877064563229081*^9, 3.8770648172356677`*^9, 
   3.8770649182267847`*^9, 3.877065010806564*^9, 3.8770656322374463`*^9, 
   3.877066671467812*^9, 3.8770668670278654`*^9, 3.877066925781698*^9, 
   3.87706708491*^9, 3.877067291702668*^9, 3.8770675795711827`*^9, 
   3.877067629573022*^9, 3.8770676773962393`*^9, 3.8770678379502745`*^9, 
   3.8770679509145284`*^9, 3.877068218819289*^9, 3.8770683559408937`*^9, 
   3.877073416230164*^9, {3.8770737407463083`*^9, 3.8770737911392803`*^9}, 
   3.8770738395541353`*^9, 3.8770764894603524`*^9, 3.87708143964832*^9, 
   3.8770815027910357`*^9, 3.8770815430521307`*^9, 3.8770819574858503`*^9},
 CellLabel->
  "Out[130]=",ExpressionUUID->"f9bfadff-3dce-4c22-ae11-c47c17068236"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5000", ",", "2", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{
  3.877063640689625*^9, {3.877063754262088*^9, 3.877063778978283*^9}, 
   3.877064355453601*^9, 3.877064563229081*^9, 3.8770648172356677`*^9, 
   3.8770649182267847`*^9, 3.877065010806564*^9, 3.8770656322374463`*^9, 
   3.877066671467812*^9, 3.8770668670278654`*^9, 3.877066925781698*^9, 
   3.87706708491*^9, 3.877067291702668*^9, 3.8770675795711827`*^9, 
   3.877067629573022*^9, 3.8770676773962393`*^9, 3.8770678379502745`*^9, 
   3.8770679509145284`*^9, 3.877068218819289*^9, 3.8770683559408937`*^9, 
   3.877073416230164*^9, {3.8770737407463083`*^9, 3.8770737911392803`*^9}, 
   3.8770738395541353`*^9, 3.8770764894603524`*^9, 3.87708143964832*^9, 
   3.8770815027910357`*^9, 3.8770815430521307`*^9, 3.877081957490837*^9},
 CellLabel->
  "Out[131]=",ExpressionUUID->"b315de1f-edf2-4d94-abfe-a069b7dfce9a"],

Cell[BoxData[
 TemplateBox[{
  "CompiledFunction", "pext", 
   "\"Instruction \\!\\(\\*RowBox[{\\\"17\\\"}]\\) in \\!\\(\\*RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}]\\) calls ordinary \
code that can be evaluated on only one thread at a time.\"", 2, 133, 120, 
   16694436375348279262, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8770819574988146`*^9},
 CellLabel->
  "During evaluation of \
In[119]:=",ExpressionUUID->"ef3a9f21-6a08-4c31-8383-a8dc88c3c4c3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.5247914`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.877063640689625*^9, {3.877063754262088*^9, 3.877063778978283*^9}, 
   3.877064355453601*^9, 3.877064563229081*^9, 3.8770648172356677`*^9, 
   3.8770649182267847`*^9, 3.877065010806564*^9, 3.8770656322374463`*^9, 
   3.877066671467812*^9, 3.8770668670278654`*^9, 3.877066925781698*^9, 
   3.87706708491*^9, 3.877067291702668*^9, 3.8770675795711827`*^9, 
   3.877067629573022*^9, 3.8770676773962393`*^9, 3.8770678379502745`*^9, 
   3.8770679509145284`*^9, 3.877068218819289*^9, 3.8770683559408937`*^9, 
   3.877073416230164*^9, {3.8770737407463083`*^9, 3.8770737911392803`*^9}, 
   3.8770738395541353`*^9, 3.8770764894603524`*^9, 3.87708143964832*^9, 
   3.8770815027910357`*^9, 3.8770815430521307`*^9, 3.8770819626285324`*^9},
 CellLabel->
  "Out[133]=",ExpressionUUID->"5d7afb6b-00ff-40d9-9e14-7c236e4f69f5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5000", ",", "2", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{
  3.877063640689625*^9, {3.877063754262088*^9, 3.877063778978283*^9}, 
   3.877064355453601*^9, 3.877064563229081*^9, 3.8770648172356677`*^9, 
   3.8770649182267847`*^9, 3.877065010806564*^9, 3.8770656322374463`*^9, 
   3.877066671467812*^9, 3.8770668670278654`*^9, 3.877066925781698*^9, 
   3.87706708491*^9, 3.877067291702668*^9, 3.8770675795711827`*^9, 
   3.877067629573022*^9, 3.8770676773962393`*^9, 3.8770678379502745`*^9, 
   3.8770679509145284`*^9, 3.877068218819289*^9, 3.8770683559408937`*^9, 
   3.877073416230164*^9, {3.8770737407463083`*^9, 3.8770737911392803`*^9}, 
   3.8770738395541353`*^9, 3.8770764894603524`*^9, 3.87708143964832*^9, 
   3.8770815027910357`*^9, 3.8770815430521307`*^9, 3.877081962634514*^9},
 CellLabel->
  "Out[134]=",ExpressionUUID->"40f01f6e-e83b-40be-b8ba-4547dd01bf2a"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8770763957654176`*^9, 3.8770764002901692`*^9}, 
   3.8770764322085247`*^9},ExpressionUUID->"4dfcae3e-67f5-477c-b9af-\
636fe29a6f72"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ThreeByThreeInverse", " ", "=", " ", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"A", ",", " ", "_Complex", ",", " ", "2"}], "}"}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"trA", ",", "A2", ",", "trA2", ",", "detA", ",", "Id"}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"trA", " ", "=", " ", 
          RowBox[{
           RowBox[{"A", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
           RowBox[{"A", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], "+", 
           RowBox[{"A", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"A2", "=", 
          RowBox[{"A", ".", "A"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"trA2", "=", 
          RowBox[{
           RowBox[{"A2", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
           RowBox[{"A2", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], "+", 
           RowBox[{"A2", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Id", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "determinant", " ", "according", " ", "to", " ", "Sarrus", " ", 
           "rule"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"detA", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
            RowBox[{"A", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], "*", 
            RowBox[{"A", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"A", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", 
            RowBox[{"A", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "3"}], "]"}], "]"}], "*", 
            RowBox[{"A", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"A", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3"}], "]"}], "]"}], "*", 
            RowBox[{"A", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
            RowBox[{"A", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
           "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"A", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "1"}], "]"}], "]"}], "*", 
              RowBox[{"A", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], "*", 
              RowBox[{"A", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"A", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "2"}], "]"}], "]"}], "*", 
              RowBox[{"A", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
              RowBox[{"A", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"A", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
              RowBox[{"A", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "3"}], "]"}], "]"}], "*", 
              RowBox[{"A", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Cayley", " ", "-", " ", 
           RowBox[{
           "Hamilton", " ", "formula", " ", "for", " ", "3", "x3", " ", 
            "matrix"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1.", "/", "detA"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"0.5", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"trA", "^", "2"}], "-", "trA2"}], ")"}], "*", "Id"}], 
             " ", "-", " ", 
             RowBox[{"trA", "*", "A"}], " ", "+", " ", "A2"}], ")"}]}], 
          "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
      RowBox[{"RuntimeAttributes", "->", 
       RowBox[{"{", "Listable", "}"}]}], ",", 
      RowBox[{"Parallelization", "->", "True"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FourByFourInverse", " ", "=", " ", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"A", ",", " ", "_Complex", ",", " ", "2"}], "}"}], 
        "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Module", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "trA", ",", "detA", ",", "A2", ",", "A3", ",", "trA2", ",", "trA3", 
           ",", "Id"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"trA", " ", "=", " ", 
           RowBox[{
            RowBox[{"A", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
            RowBox[{"A", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], "+", 
            RowBox[{"A", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"A2", "=", 
           RowBox[{"A", ".", "A"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"trA2", "=", 
           RowBox[{
            RowBox[{"A2", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
            RowBox[{"A2", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], "+", 
            RowBox[{"A2", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"A3", "=", 
           RowBox[{"A2", ".", "A"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Id", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "determinant", " ", "according", " ", "to", " ", "Sarrus", " ", 
            "rule"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"detA", " ", "="}], " ", ";"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Cayley", " ", "-", " ", 
          RowBox[{
          "Hamilton", " ", "formula", " ", "for", " ", "3", "x3", " ", 
           "matrix"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
       RowBox[{"RuntimeAttributes", "->", 
        RowBox[{"{", "Listable", "}"}]}], ",", 
       RowBox[{"Parallelization", "->", "True"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.8770780349903507`*^9, 3.8770780359407845`*^9}, {
  3.8770788442296357`*^9, 3.877078930935825*^9}, {3.8770790405151434`*^9, 
  3.8770792798063393`*^9}, {3.8770793323431635`*^9, 3.877079351481495*^9}, {
  3.8770793873258686`*^9, 3.8770796004552097`*^9}, {3.877079664989861*^9, 
  3.877079729484107*^9}, {3.8770798715916295`*^9, 3.8770799467894106`*^9}, {
  3.8770803828145857`*^9, 3.8770803926794147`*^9}, {3.877080431593474*^9, 
  3.8770804855002155`*^9}, {3.877081717466503*^9, 3.8770817293368855`*^9}, {
  3.8770819442957425`*^9, 
  3.877081948298381*^9}},ExpressionUUID->"e15fb145-179f-4a25-87d1-\
a657242b3df6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", 
   RowBox[{"RandomComplex", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.", ",", 
       RowBox[{"1.", "+", "I"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10000", ",", "3", ",", "3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Inverse", "[", "#", "]"}], "&"}], "/@", "m"}], ";"}], "//", 
  "RepeatedTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ThreeByThreeInverse", "[", "m", "]"}], ";"}], "//", 
   "RepeatedTiming"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ThreeByThreeInverse", "[", 
     RowBox[{"m", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
    RowBox[{"m", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "//", "Chop"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8770797397470436`*^9, 3.877079839197375*^9}, {
  3.877079976402051*^9, 3.877079981764681*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"64593be0-0c55-483d-bdf2-2024808135d6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.05262808125`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.877079735546788*^9, 3.877079787196933*^9}, {
   3.8770798265500994`*^9, 3.8770798407371464`*^9}, 3.8770798822982607`*^9, 
   3.877079985099942*^9},
 CellLabel->"Out[69]=",ExpressionUUID->"3f5a05c2-f4b8-4dff-84cf-f6f946345a32"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.002817814453125`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.877079735546788*^9, 3.877079787196933*^9}, {
   3.8770798265500994`*^9, 3.8770798407371464`*^9}, 3.8770798822982607`*^9, 
   3.8770799866687455`*^9},
 CellLabel->"Out[70]=",ExpressionUUID->"cf661548-798d-4706-ad1d-b4299a275432"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.0000000000000013`", "0", "0"},
     {"0", "0.9999999999999996`", "0"},
     {"0", "0", "1.0000000000000016`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.877079735546788*^9, 3.877079787196933*^9}, {
   3.8770798265500994`*^9, 3.8770798407371464`*^9}, 3.8770798822982607`*^9, 
   3.877079986673732*^9},
 CellLabel->
  "Out[71]//MatrixForm=",ExpressionUUID->"1ff7058b-1378-4b8e-a0bf-\
b09a39f2b22e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"LocalGreenFunctionFullSuperc", " ", "=", " ", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Energies", ",", "_Real", ",", "3"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"weights", ",", "_Real", ",", "1"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"\[Mu]", ",", " ", "_Real"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"\[CapitalSigma]", ",", " ", "_Complex", ",", " ", "3"}], 
        "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"zlist", ",", " ", "_Complex", ",", " ", "1"}], "}"}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{"With", "[", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LE", " ", "=", " ", 
          RowBox[{"Length", "[", "Energies", "]"}]}], ",", " ", 
         RowBox[{"Norb", " ", "=", " ", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Energies", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "2"}], "]"}]}], ",",
          " ", 
         RowBox[{"NMatsubara", " ", "=", " ", 
          RowBox[{"Length", "[", "zlist", "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{"compute", " ", "Gloc"}], " ", "*)"}], "\t", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Total", "@", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"weights", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"Inverse", "[", "#", "]"}]}], "&"}], "/@", 
           RowBox[{"(", "\[IndentingNewLine]", "\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"IdentityMatrix", "[", 
                  RowBox[{"2", "*", "Norb"}], "]"}], "*", "#"}], ")"}], "&"}],
               "/@", "zlist"}], "\[IndentingNewLine]", "\t\t\t\t", "+", 
             RowBox[{"ConstantArray", "[", "\[IndentingNewLine]", "\t\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Mu]", "*", 
                 RowBox[{"DiagonalMatrix", "[", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"j", "+", "1"}], ")"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"2", "*", "Norb"}]}], "}"}]}], "]"}], "]"}]}], 
                " ", "\[IndentingNewLine]", "\t\t\t\t", "-", " ", 
                RowBox[{"Energies", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ",", "NMatsubara"}], "]"}],
              " ", "-", " ", "\[CapitalSigma]"}], "\[IndentingNewLine]", 
            "\t\t\t", ")"}]}], "\[IndentingNewLine]", "\t\t", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "LE"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{"RuntimeAttributes", "->", 
      RowBox[{"{", "Listable", "}"}]}], ",", " ", 
     RowBox[{"Parallelization", "->", "True"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8770818005285873`*^9, 3.877081833613822*^9}, {
  3.8770824456273546`*^9, 3.877082447146434*^9}, {3.8770827621189013`*^9, 
  3.8770827941918297`*^9}, {3.877082851860649*^9, 3.8770828542020135`*^9}, {
  3.877085631948201*^9, 3.8770856415385704`*^9}, {3.8770867414114923`*^9, 
  3.8770867416268325`*^9}, {3.8770870212205334`*^9, 3.8770870518559074`*^9}, {
  3.8770871073527255`*^9, 3.8770871077795963`*^9}, {3.8770872085985703`*^9, 
  3.877087213818964*^9}, {3.8770873545018044`*^9, 3.877087377813755*^9}, {
  3.8770874506857862`*^9, 3.8770874857539444`*^9}, {3.877087639125641*^9, 
  3.877087672939561*^9}},
 CellLabel->
  "In[247]:=",ExpressionUUID->"49bf2a2a-f794-47a2-9524-12cada67a938"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nMats", " ", "=", " ", "5000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nK", " ", "=", " ", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Norb", "=", "2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalSigma]", "=", 
   RowBox[{"RandomComplex", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1."}], "-", "I"}], ",", 
       RowBox[{"1.", "+", "I"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nMats", ",", 
       RowBox[{"2", "*", "Norb"}], ",", 
       RowBox[{"2", "*", "Norb"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zlist", " ", "=", " ", 
   RowBox[{"I", "*", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.", ",", "1."}], "}"}], ",", "nMats"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d", "=", "1"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BZ", " ", "=", " ", 
     RowBox[{"BrillouinZone", "[", 
      RowBox[{"nK", ",", " ", "d"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Energies", " ", "=", " ", 
     RowBox[{"DispersionHypercubic", "[", 
      RowBox[{"BZ", ",", " ", "1."}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"weights", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"1.", "/", 
        RowBox[{"(", 
         RowBox[{"nK", "^", "d"}], ")"}]}], ",", " ", "nK"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Alpha]", "=", "0.5"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Energies", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"e", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "e"}], ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"\[Alpha]", "*", "e"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", 
         RowBox[{
          RowBox[{"-", "\[Alpha]"}], "*", "e"}]}], "}"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"e", ",", 
       RowBox[{"-", "1."}], ",", "1.", ",", "0.01"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"weights", " ", "=", " ", 
    RowBox[{"DoSBethe", "[", 
     RowBox[{
      RowBox[{"Energies", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], ",", " ", "1."}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Gloc", " ", "=", " ", 
     RowBox[{"LocalGreenFunctionFullSuperc", "[", 
      RowBox[{
      "Energies", ",", " ", "weights", ",", " ", "0.0", ",", " ", 
       "\[CapitalSigma]", ",", " ", "zlist"}], "]"}]}], ";"}], ")"}], "//", 
  "RepeatedTiming"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "Gloc", "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.877086832560849*^9, 3.877086835527814*^9}, {
  3.877086868691205*^9, 3.8770869281822877`*^9}, {3.877086959047451*^9, 
  3.87708696247492*^9}},
 CellLabel->
  "In[248]:=",ExpressionUUID->"1a631497-521d-41b4-b78e-d29f6779d8ed"],

Cell[BoxData["0.5`"], "Output",
 CellChangeTimes->{
  3.8770868742258186`*^9, {3.8770869384315434`*^9, 3.877086963073536*^9}, 
   3.877087074508247*^9, 3.8770871434761305`*^9, 3.87708721848899*^9, {
   3.877087365562685*^9, 3.8770873860342655`*^9}, 3.8770874973500752`*^9, 
   3.877087698033231*^9},
 CellLabel->
  "Out[254]=",ExpressionUUID->"febecf80-79f3-4e99-ac89-ee7e112de94b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6.778609`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8770868742258186`*^9, {3.8770869384315434`*^9, 3.877086963073536*^9}, 
   3.877087074508247*^9, 3.8770871434761305`*^9, 3.87708721848899*^9, {
   3.877087365562685*^9, 3.8770873860342655`*^9}, 3.8770874973500752`*^9, 
   3.877087711636834*^9},
 CellLabel->
  "Out[257]=",ExpressionUUID->"67c6086c-b67a-476c-a737-e87ee19b90d5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5000", ",", "4", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8770868742258186`*^9, {3.8770869384315434`*^9, 3.877086963073536*^9}, 
   3.877087074508247*^9, 3.8770871434761305`*^9, 3.87708721848899*^9, {
   3.877087365562685*^9, 3.8770873860342655`*^9}, 3.8770874973500752`*^9, 
   3.8770877116418467`*^9},
 CellLabel->
  "Out[258]=",ExpressionUUID->"4756b91d-87bc-44bb-9261-fc50bbefe717"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Mu]", "*", 
  RowBox[{"DiagonalMatrix", "@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"j", "+", "1"}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"2", "Norb"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8770871996296988`*^9, 3.8770872020688953`*^9}, {
  3.877087402209294*^9, 3.877087428654997*^9}},
 CellLabel->
  "In[234]:=",ExpressionUUID->"8eb69b0b-2bd5-47bf-8b4a-420560c086ee"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Mu]", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "\[Mu]"}], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "\[Mu]", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     RowBox[{"-", "\[Mu]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.877087202452602*^9, {3.877087412877921*^9, 3.8770874290723395`*^9}},
 CellLabel->
  "Out[234]=",ExpressionUUID->"3c808e35-dc8f-47c3-b858-af358b9f6082"]
}, Open  ]]
},
WindowSize->{1428., 735.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.1 for Microsoft Windows (64-bit) (August 22, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"d27093fd-b480-439d-bfdc-e1e9b9ca8952"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 961, 19, 67, "Input",ExpressionUUID->"ec107a83-c730-43bd-99c5-6490f83726d6"],
Cell[1544, 43, 364, 10, 28, "Message",ExpressionUUID->"7f04d198-c75c-410b-b4e6-6c5b506349ca"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1945, 58, 191, 2, 28, "Input",ExpressionUUID->"38c7cc1b-1b1d-41a4-b479-726709c34dd4"],
Cell[2139, 62, 241, 3, 32, "Output",ExpressionUUID->"885687e6-daf0-4b12-82a1-f8e0222fb44d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2417, 70, 569, 11, 48, "Input",ExpressionUUID->"4cc05509-f747-44b6-9280-93be3516e01a"],
Cell[2989, 83, 315, 5, 32, "Output",ExpressionUUID->"941b86ed-0bc5-4a3a-948c-5cd3445c8144"]
}, Open  ]],
Cell[3319, 91, 8087, 167, 790, "Input",ExpressionUUID->"1554ec47-9bd2-4957-848d-e8ac4790ab36"],
Cell[CellGroupData[{
Cell[11431, 262, 3398, 93, 390, "Input",ExpressionUUID->"bc9651f1-2593-467a-9abd-5f28b51d7397"],
Cell[14832, 357, 1366, 21, 32, "Output",ExpressionUUID->"efd9b544-54fb-4145-a0a5-b1b5f9e71128"],
Cell[16201, 380, 1365, 21, 32, "Output",ExpressionUUID->"7280c559-64ea-4e88-b922-8b7b0442a26f"],
Cell[17569, 403, 1366, 21, 32, "Output",ExpressionUUID->"c6087ae8-9306-43e3-9efd-20d2bf22eb77"],
Cell[18938, 426, 1355, 21, 32, "Output",ExpressionUUID->"99c98edf-6caf-4276-ae70-8199358c02c4"]
}, Open  ]],
Cell[20308, 450, 18871, 427, 1208, "Input",ExpressionUUID->"7671d138-d6c9-4a7d-9714-836b6ff1ea41"],
Cell[CellGroupData[{
Cell[39204, 881, 3807, 101, 390, "Input",ExpressionUUID->"5f260183-e281-448d-a532-6030190dee1f"],
Cell[43014, 984, 490, 9, 32, "Output",ExpressionUUID->"37ae0afb-3d26-4d26-853c-15214d2a32b9"],
Cell[43507, 995, 490, 9, 32, "Output",ExpressionUUID->"a2dead5d-6844-4b93-8ad4-942291ba0785"],
Cell[44000, 1006, 489, 9, 32, "Output",ExpressionUUID->"841519e0-17bf-43ee-b865-9c70990a8a94"],
Cell[44492, 1017, 489, 9, 32, "Output",ExpressionUUID->"2df5a0f4-d9a4-4666-8e90-42450c74d48a"],
Cell[44984, 1028, 500, 9, 32, "Output",ExpressionUUID->"8dd90e39-536c-4b35-b06b-3f8ed682202c"]
}, Open  ]],
Cell[45499, 1040, 12427, 287, 923, "Input",ExpressionUUID->"dc874c6a-6359-483f-83a4-5af588992eae"],
Cell[CellGroupData[{
Cell[57951, 1331, 4400, 115, 485, "Input",ExpressionUUID->"604c1490-9df0-4389-9b07-7a7b5ab43114"],
Cell[62354, 1448, 862, 13, 32, "Output",ExpressionUUID->"1f26655e-b923-4909-b2c6-773e5bac6a25"],
Cell[63219, 1463, 918, 15, 32, "Output",ExpressionUUID->"372b81ef-7bde-4a86-8792-b0719eee4d12"],
Cell[64140, 1480, 919, 15, 32, "Output",ExpressionUUID->"06a53c90-6fe9-43f5-b9c1-513fa08bd1c7"],
Cell[65062, 1497, 919, 15, 32, "Output",ExpressionUUID->"f9bfadff-3dce-4c22-ae11-c47c17068236"],
Cell[65984, 1514, 917, 15, 32, "Output",ExpressionUUID->"b315de1f-edf2-4d94-abfe-a069b7dfce9a"],
Cell[66904, 1531, 516, 11, 28, "Message",ExpressionUUID->"ef3a9f21-6a08-4c31-8383-a8dc88c3c4c3"],
Cell[67423, 1544, 918, 15, 32, "Output",ExpressionUUID->"5d7afb6b-00ff-40d9-9e14-7c236e4f69f5"],
Cell[68344, 1561, 917, 15, 32, "Output",ExpressionUUID->"40f01f6e-e83b-40be-b8ba-4547dd01bf2a"]
}, Open  ]],
Cell[69276, 1579, 181, 3, 28, "Input",ExpressionUUID->"4dfcae3e-67f5-477c-b9af-636fe29a6f72"],
Cell[69460, 1584, 9363, 227, 733, "Input",ExpressionUUID->"e15fb145-179f-4a25-87d1-a657242b3df6"],
Cell[CellGroupData[{
Cell[78848, 1815, 1098, 33, 105, "Input",ExpressionUUID->"64593be0-0c55-483d-bdf2-2024808135d6"],
Cell[79949, 1850, 338, 6, 32, "Output",ExpressionUUID->"3f5a05c2-f4b8-4dff-84cf-f6f946345a32"],
Cell[80290, 1858, 344, 6, 32, "Output",ExpressionUUID->"cf661548-798d-4706-ad1d-b4299a275432"],
Cell[80637, 1866, 834, 22, 79, "Output",ExpressionUUID->"1ff7058b-1378-4b8e-a0bf-b09a39f2b22e"]
}, Open  ]],
Cell[81486, 1891, 4231, 93, 333, "Input",ExpressionUUID->"49bf2a2a-f794-47a2-9524-12cada67a938"],
Cell[CellGroupData[{
Cell[85742, 1988, 3432, 95, 371, "Input",ExpressionUUID->"1a631497-521d-41b4-b78e-d29f6779d8ed"],
Cell[89177, 2085, 382, 7, 32, "Output",ExpressionUUID->"febecf80-79f3-4e99-ac89-ee7e112de94b"],
Cell[89562, 2094, 435, 9, 32, "Output",ExpressionUUID->"67c6086c-b67a-476c-a737-e87ee19b90d5"],
Cell[90000, 2105, 439, 9, 32, "Output",ExpressionUUID->"4756b91d-87bc-44bb-9261-fc50bbefe717"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90476, 2119, 559, 16, 28, "Input",ExpressionUUID->"8eb69b0b-2bd5-47bf-8b4a-420560c086ee"],
Cell[91038, 2137, 603, 16, 32, "Output",ExpressionUUID->"3c808e35-dc8f-47c3-b858-af358b9f6082"]
}, Open  ]]
}
]
*)

